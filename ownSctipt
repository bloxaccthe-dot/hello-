local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

-- ğŸªŸ GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "StickyBangGUI"
ScreenGui.Parent = game:GetService("CoreGui")

local Frame = Instance.new("Frame")
Frame.Size = UDim2.new(0, 320, 0, 230)
Frame.Position = UDim2.new(0.5, -160, 0.3, 0)
Frame.BackgroundColor3 = Color3.fromRGB(25,25,25)
Frame.BorderSizePixel = 0
Frame.Active = true
Frame.Parent = ScreenGui
Frame.ClipsDescendants = true
Frame.AnchorPoint = Vector2.new(0.5,0.5)

local UICorner = Instance.new("UICorner")
UICorner.CornerRadius = UDim.new(0,12)
UICorner.Parent = Frame

-- âœ‹ Ø³Ø­Ø¨
local dragging, dragInput, dragStart, startPos
Frame.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = Frame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then
                dragging = false
            end
        end)
    end
end)
Frame.InputChanged:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
        dragInput = input
    end
end)
UserInputService.InputChanged:Connect(function(input)
    if dragging and input == dragInput then
        local delta = input.Position - dragStart
        Frame.Position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
    end
end)

-- ğŸ’¬ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†
local TitleBar = Instance.new("Frame")
TitleBar.Size = UDim2.new(1,0,0,35)
TitleBar.BackgroundColor3 = Color3.fromRGB(15,15,15)
TitleBar.Parent = Frame

local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1,-70,1,0)
Title.Position = UDim2.new(0,10,0,0)
Title.BackgroundTransparency = 1
Title.Text = "ğŸ”¥ Lac - By:kaljjaj ğŸ”¥"
Title.TextColor3 = Color3.fromRGB(255,255,255)
Title.Font = Enum.Font.GothamBold
Title.TextSize = 20
Title.TextXAlignment = Enum.TextXAlignment.Left
Title.Parent = TitleBar

-- Ø²Ø± Ø¥ØºÙ„Ø§Ù‚
local CloseBtn = Instance.new("TextButton")
CloseBtn.Size = UDim2.new(0,30,0,30)
CloseBtn.Position = UDim2.new(1,-35,0,3)
CloseBtn.BackgroundColor3 = Color3.fromRGB(200,50,50)
CloseBtn.Text = "âœ–"
CloseBtn.TextColor3 = Color3.new(1,1,1)
CloseBtn.Font = Enum.Font.GothamBold
CloseBtn.TextSize = 20
CloseBtn.Parent = TitleBar
local UICorner3 = Instance.new("UICorner")
UICorner3.CornerRadius = UDim.new(0,8)
UICorner3.Parent = CloseBtn

-- Ø²Ø± Ø§Ù„Ø·ÙŠ/Ø§Ù„ÙØªØ­
local ToggleBtn = Instance.new("TextButton")
ToggleBtn.Size = UDim2.new(0,30,0,30)
ToggleBtn.Position = UDim2.new(1,-70,0,3)
ToggleBtn.BackgroundColor3 = Color3.fromRGB(50,150,200)
ToggleBtn.Text = "â¬‡"
ToggleBtn.TextColor3 = Color3.new(1,1,1)
ToggleBtn.Font = Enum.Font.GothamBold
ToggleBtn.TextSize = 20
ToggleBtn.Parent = TitleBar
local UICornerToggle = Instance.new("UICorner")
UICornerToggle.CornerRadius = UDim.new(0,8)
UICornerToggle.Parent = ToggleBtn

--ğŸ“‚ Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ù…Ø­ØªÙˆÙ‰
local Content = Instance.new("Frame")
Content.Size = UDim2.new(1,0,1,-35)
Content.Position = UDim2.new(0,0,0,35)
Content.BackgroundTransparency = 1
Content.Parent = Frame

-- Ù…Ø±Ø¨Ø¹ ÙƒØªØ§Ø¨Ø©
local TextBox = Instance.new("TextBox")
TextBox.Size = UDim2.new(1,-30,0,40)
TextBox.Position = UDim2.new(0,15,0,20)
TextBox.PlaceholderText = "Ø§ÙƒØªØ¨ Ø£ÙˆÙ„ Ø­Ø±ÙÙŠÙ† Ù…Ù† Ø§Ø³Ù… Ø§Ù„Ù‡Ø¯Ù"
TextBox.ClearTextOnFocus = false
TextBox.TextColor3 = Color3.fromRGB(255,255,255)
TextBox.BackgroundColor3 = Color3.fromRGB(40,40,40)
TextBox.Font = Enum.Font.Gotham
TextBox.TextSize = 18
TextBox.Parent = Content
local UICorner4 = Instance.new("UICorner")
UICorner4.CornerRadius = UDim.new(0,8)
UICorner4.Parent = TextBox

-- Ø²Ø± Bang (Ø®Ù„Ù)
local AttachBtn = Instance.new("TextButton")
AttachBtn.Size = UDim2.new(1,-30,0,45)
AttachBtn.Position = UDim2.new(0,15,0,75)
AttachBtn.BackgroundColor3 = Color3.fromRGB(0,150,80)
AttachBtn.Text = "ğŸš€ Bang"
AttachBtn.TextColor3 = Color3.fromRGB(255,255,255)
AttachBtn.Font = Enum.Font.GothamBold
AttachBtn.TextSize = 20
AttachBtn.Parent = Content
local UICorner5 = Instance.new("UICorner")
UICorner5.CornerRadius = UDim.new(0,10)
UICorner5.Parent = AttachBtn

-- Ø²Ø± Face Bang (Ø£Ù…Ø§Ù…)
local FaceBtn = Instance.new("TextButton")
FaceBtn.Size = UDim2.new(1,-30,0,45)
FaceBtn.Position = UDim2.new(0,15,0,130)
FaceBtn.BackgroundColor3 = Color3.fromRGB(150,80,0)
FaceBtn.Text = "ğŸ’¥ Face Bang ğŸš€"
FaceBtn.TextColor3 = Color3.fromRGB(255,255,255)
FaceBtn.Font = Enum.Font.GothamBold
FaceBtn.TextSize = 20
FaceBtn.Parent = Content
local UICorner6 = Instance.new("UICorner")
UICorner6.CornerRadius = UDim.new(0,10)
UICorner6.Parent = FaceBtn

-- ğŸ—‚ï¸ Ù…Ù†Ø·Ù‚ Ø§Ù„Ø·ÙŠ/Ø§Ù„ÙØªØ­
local collapsed = false
ToggleBtn.MouseButton1Click:Connect(function()
    collapsed = not collapsed
    if collapsed then
        Content.Visible = false
        Frame.Size = UDim2.new(0,320,0,40)
        ToggleBtn.Text = "â¬†"
    else
        Content.Visible = true
        Frame.Size = UDim2.new(0,320,0,230)
        ToggleBtn.Text = "â¬‡"
    end
end)

-- ğŸ” Ø§Ù„Ù…Ù†Ø·Ù‚
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoidRootPart = character:WaitForChild("HumanoidRootPart")

-- Ø®Ù„Ù
local attached, connection, targetPlayer
-- Ø£Ù…Ø§Ù…
local faceAttached, faceConnection, faceTarget

local function findPlayerByNamePrefix(prefix)
    prefix = prefix:lower()
    for _, plr in pairs(Players:GetPlayers()) do
        if plr ~= player and plr.Name:lower():sub(1, #prefix) == prefix then
            return plr
        end
    end
    return nil
end

-- Bang Ø®Ù„ÙÙŠ
local function startBang(targetHRP, targetPlr)
    local baseDistance, direction, speed, currentOffset = 1.2, 1, 6, 1.2
    if connection then connection:Disconnect() end
    connection = RunService.RenderStepped:Connect(function(delta)
        if not attached or not targetPlr.Character or not targetPlr.Character:FindFirstChild("HumanoidRootPart") then
            attached = false; AttachBtn.Text = "ğŸš€ Bang"; if connection then connection:Disconnect() end; return
        end
        local myHRP = player.Character and player.Character:FindFirstChild("HumanoidRootPart"); if not myHRP then return end
        currentOffset = currentOffset + direction * speed * delta
        if currentOffset > baseDistance + 0.5 then direction = -1 elseif currentOffset < baseDistance - 0.5 then direction = 1 end
        local targetPos, targetLook = targetHRP.Position, targetHRP.CFrame.LookVector
        myHRP.CFrame = CFrame.new(targetPos - targetLook * currentOffset, targetPos)
    end)
end

-- Face Bang Ø£Ù…Ø§Ù…ÙŠ
local function startFaceBang(targetPlr)
    local direction, speed, currentOffset = 1, 6, 1.2
    if faceConnection then faceConnection:Disconnect() end
    faceConnection = RunService.RenderStepped:Connect(function(delta)
        if not faceAttached or not targetPlr.Character then
            faceAttached = false; FaceBtn.Text = "ğŸ’¥ Face Bang ğŸš€"; if faceConnection then faceConnection:Disconnect() end; return
        end
        local targetHead = targetPlr.Character:FindFirstChild("Head")
        local myHRP = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
        if not targetHead or not myHRP then return end
        currentOffset = currentOffset + direction * speed * delta
        if currentOffset > 1.7 then direction = -1 elseif currentOffset < 0.7 then direction = 1 end
        local facePosition = targetHead.Position + Vector3.new(0, 0.3, 0)
        local offsetPosition = facePosition + targetHead.CFrame.LookVector * currentOffset
        myHRP.CFrame = CFrame.new(offsetPosition, facePosition)
    end)
end

-- ğŸš€ Ø²Ø± Bang
AttachBtn.MouseButton1Click:Connect(function()
    if attached then
        attached = false; targetPlayer=nil; AttachBtn.Text="ğŸš€ Bang"; if connection then connection:Disconnect() end; return
    end
    -- ğŸ”´ Ø¥Ø°Ø§ ÙƒØ§Ù† Face Bang Ø´ØºØ§Ù„ -> Ø·ÙÙŠÙ‡
    if faceAttached then
        faceAttached=false; faceTarget=nil; FaceBtn.Text="ğŸ’¥ Face Bang ğŸš€"; if faceConnection then faceConnection:Disconnect() end
    end
    local prefix = TextBox.Text; if prefix=="" then warn("Ø§ÙƒØªØ¨ Ø£ÙˆÙ„ Ø­Ø±ÙÙŠÙ† Ù…Ù† Ø§Ø³Ù… Ø§Ù„Ù‡Ø¯Ù") return end
    local newTarget = findPlayerByNamePrefix(prefix); if not newTarget or not newTarget.Character or not newTarget.Character:FindFirstChild("HumanoidRootPart") then warn("Ø§Ù„Ù„Ø§Ø¹Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯") return end
    targetPlayer = newTarget; attached = true; AttachBtn.Text="Ø¥ÙŠÙ‚Ø§Ù âŒ"; startBang(newTarget.Character.HumanoidRootPart, newTarget)
end)

-- ğŸ’¥ Ø²Ø± Face Bang
FaceBtn.MouseButton1Click:Connect(function()
    if faceAttached then
        faceAttached = false; faceTarget=nil; FaceBtn.Text="ğŸ’¥ Face Bang ğŸš€"; if faceConnection then faceConnection:Disconnect() end; return
    end
    -- ğŸ”´ Ø¥Ø°Ø§ ÙƒØ§Ù† Bang Ø´ØºØ§Ù„ -> Ø·ÙÙŠÙ‡
    if attached then
        attached=false; targetPlayer=nil; AttachBtn.Text="ğŸš€ Bang"; if connection then connection:Disconnect() end
    end
    local prefix = TextBox.Text; if prefix=="" then warn("Ø§ÙƒØªØ¨ Ø£ÙˆÙ„ Ø­Ø±ÙÙŠÙ† Ù…Ù† Ø§Ø³Ù… Ø§Ù„Ù‡Ø¯Ù") return end
    local newTarget = findPlayerByNamePrefix(prefix); if not newTarget or not newTarget.Character or not newTarget.Character:FindFirstChild("Head") then warn("Ø§Ù„Ù„Ø§Ø¹Ø¨ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯") return end
    faceTarget=newTarget; faceAttached=true; FaceBtn.Text="Ø¥ÙŠÙ‚Ø§Ù âŒ"; startFaceBang(faceTarget)
end)

-- ğŸŒ€ Ø¥Ø¹Ø§Ø¯Ø© ØªÙØ¹ÙŠÙ„ Ø¨Ø¹Ø¯ Ø§Ù„Ù…ÙˆØª
player.CharacterAdded:Connect(function(char)
    character=char; humanoidRootPart=character:WaitForChild("HumanoidRootPart")
    if attached and targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then task.wait(1) startBang(targetPlayer.Character.HumanoidRootPart, targetPlayer) end
    if faceAttached and faceTarget and faceTarget.Character and faceTarget.Character:FindFirstChild("Head") then task.wait(1) startFaceBang(faceTarget) end
end)

-- âŒ Ø²Ø± Ø§Ù„Ø¥ØºÙ„Ø§Ù‚
CloseBtn.MouseButton1Click:Connect(function()
    ScreenGui:Destroy()
    if connection then connection:Disconnect() end
    if faceConnection then faceConnection:Disconnect() end
    attached, faceAttached=false,false; targetPlayer, faceTarget=nil,nil
end)
